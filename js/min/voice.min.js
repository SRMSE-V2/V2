var ResponsiveVoice=function(){function e(){"undefined"==typeof speechSynthesis?a():setTimeout(function(){var e=setInterval(function(){var l=window.speechSynthesis.getVoices()
0!=l.length||null!=c&&0!=c.length?(console.log("Voice support ready"),clearInterval(e),c=l,n(),null!=t.OnVoiceReady&&t.OnVoiceReady.call()):(console.log("Voice support NOT ready"),v++,v>f&&(clearInterval(e),a()))},100)},100)}function a(){h=!0,console.log("Voice not supported. Using fallback mode"),n(),null!=t.OnVoiceReady&&t.OnVoiceReady.call()}function n(){for(var e=0;e<s.length;e++)for(var a=s[e],n=0;n<a.voiceIDs.length;n++){var l=r[a.voiceIDs[n]]
if(1==l.fallbackvoice){a.mappedProfile={systemvoice:{},collectionvoice:l},console.log("Mapped "+a.name+" to "+l.lang+" fallback voice")
break}var o=i(l.name)
if(null!=o){a.mappedProfile={systemvoice:o,collectionvoice:l},console.log("Mapped "+a.name+" to "+o.name)
break}}}function l(e){for(var a=0;a<e.voiceIDs.length;a++){var n=i(r[e.voiceIDs[a]].name)
if(null!=n)return n}return null}function i(e){if("undefined"==typeof c)return null
for(var a=0;a<c.length;a++)if(c[a].name==e)return c[a]
return null}function o(e){for(var a=0;a<s.length;a++)if(s[a].name==e)return s[a]
return null}var c,t=this,s=[{name:"UK English Female",voiceIDs:[3,5,1,6,7,8]},{name:"UK English Male",voiceIDs:[0,4,2,6,7,8]},{name:"US English Female",voiceIDs:[39,40,41,42,43,44]},{name:"Spanish Female",voiceIDs:[19,16,17,18,20,15]},{name:"French Female",voiceIDs:[21,22,23,26]},{name:"Deutsch Female",voiceIDs:[27,28,29,30,31,32]},{name:"Italian Female",voiceIDs:[33,34,35,36,37,38]},{name:"Hungarian Female",voiceIDs:[9,10,11]},{name:"Serbian Male",voiceIDs:[12]},{name:"Croatian Male",voiceIDs:[13]},{name:"Bosnian Male",voiceIDs:[14]},{name:"Fallback UK Female",voiceIDs:[8]}],r=[{name:"Google UK English Male"},{name:"Agnes"},{name:"Daniel Compact"},{name:"Google UK English Female"},{name:"en-GB",rate:.5,pitch:1},{name:"en-AU",rate:.5,pitch:1},{name:"inglés Reino Unido"},{name:"English United Kingdom"},{name:"Fallback en-GB Female",lang:"en-GB",fallbackvoice:!0},{name:"Eszter Compact"},{name:"hu-HU",rate:.4},{name:"Fallback Hungarian",lang:"hu",fallbackvoice:!0},{name:"Fallback Serbian",lang:"sr",fallbackvoice:!0},{name:"Fallback Croatian",lang:"hr",fallbackvoice:!0},{name:"Fallback Bosnian",lang:"bs",fallbackvoice:!0},{name:"Fallback Spanish",lang:"es",fallbackvoice:!0},{name:"Spanish Spain"},{name:"español España"},{name:"Diego Compact",rate:.3},{name:"Google Español"},{name:"es-ES",rate:.3},{name:"Google Français"},{name:"French France"},{name:"francés Francia"},{name:"Virginie Compact",rate:.5},{name:"fr-FR",rate:.5},{name:"Fallback French",lang:"fr",fallbackvoice:!0},{name:"Google Deutsch"},{name:"German Germany"},{name:"alemán Alemania"},{name:"Yannick Compact",rate:.5},{name:"de-DE",rate:.5},{name:"Fallback Deutsch",lang:"de",fallbackvoice:!0},{name:"Google Italiano"},{name:"Italian Italy"},{name:"italiano Italia"},{name:"Paolo Compact",rate:.5},{name:"it-IT",rate:.5},{name:"Fallback Italian",lang:"it",fallbackvoice:!0},{name:"Google US English"},{name:"English United States"},{name:"inglés Estados Unidos"},{name:"Vicki"},{name:"en-US",rate:.5},{name:"Fallback English",lang:"en-US",fallbackvoice:!0}],m=100,f=5,v=0,h=!1
this.fallback_playing=!1,this.fallback_parts=null,this.fallback_part_index=0,this.fallback_audio=null,"undefined"!=typeof speechSynthesis&&(speechSynthesis.onvoiceschanged=function(){c=window.speechSynthesis.getVoices(),null!=t.OnVoiceReady&&t.OnVoiceReady.call()}),this.default_rv=s[0],this.OnVoiceReady=null,"undefined"==typeof $?document.addEventListener("DOMContentLoaded",function(){e()}):$(document).ready(function(){e()}),this.getVoices=function(){for(var e=[],a=0;a<s.length;a++)e.push({name:s[a].name})
return e},this.speak=function(e,a){var n=[]
if(e.length>m){for(var i=e;i.length>m;){var c=i.search(/[:!?.;]+/),s=""
if((-1==c||c>=m)&&(c=i.search(/[,]+/)),-1==c||c>=m)for(var r=i.split(" "),f=0;f<r.length&&!(s.length+r[f].length+1>m);f++)s+=(0!=f?" ":"")+r[f]
else s=i.substr(0,c+1)
i=i.substr(s.length,i.length-s.length),n.push(s)}i.length>0&&n.push(i)}else n.push(e)
var v
v=null==a?t.default_rv:o(a)
var u={}
if(null!=v.mappedProfile)u=v.mappedProfile
else if(u.systemvoice=l(v),u.collectionvoice={},null==u.systemvoice)return void console.log("ERROR: No voice found for: "+a)
1==u.collectionvoice.fallbackvoice?(h=!0,t.fallback_parts=[]):h=!1
for(var f=0;f<n.length;f++)if(h){var g="http://www.corsproxy.com/translate.google.com/translate_tts?ie=UTF-8&q="+n[f]+"&tl="+u.collectionvoice.lang||u.systemvoice.lang||"en-US",p=new Audio(g)
p.playbackRate=1,p.preload="auto",p.volume=u.collectionvoice.volume||u.systemvoice.volume||1,t.fallback_parts.push(p)}else{var d=new SpeechSynthesisUtterance
d.voice=u.systemvoice,d.voiceURI=u.systemvoice.voiceURI,d.volume=u.collectionvoice.volume||u.systemvoice.volume||1,d.rate=u.collectionvoice.rate||u.systemvoice.rate||1,d.pitch=u.collectionvoice.pitch||u.systemvoice.pitch||1,d.text=n[f],d.lang=u.collectionvoice.lang||u.systemvoice.lang,d.onend=t.OnFinishedPlaying,d.onerror=function(e){console.log("Error"),console.log(e)},speechSynthesis.speak(d)}h&&t.fallback_startPlaying()},this.fallback_startPlaying=function(){t.fallback_part_index=0,t.fallback_finishedplaying()},this.fallback_finishedplaying=function(e){t.fallback_audio=t.fallback_parts[t.fallback_part_index],t.fallback_audio.play(),t.fallback_part_index++,t.fallback_part_index<t.fallback_parts.length&&t.fallback_audio.addEventListener("ended",t.fallback_finishedplaying)},this.cancel=function(){h?t.fallback_audio.pause():speechSynthesis.cancel()},this.voiceSupport=function(){return"speechSynthesis"in window},this.OnFinishedPlaying=function(e){},this.setDefaultVoice=function(e){var a=o(e)
null!=a&&(t.default_vr=a)}},responsiveVoice=new ResponsiveVoice
