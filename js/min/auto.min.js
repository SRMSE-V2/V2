!function(){$(document).ready(function(){function e(){$(window).width()<=600?(h.val(""),r=!1):r=!0,12.5*$("#search").val().length>=$("#search").width()&&(h.val(""),r=!1)}function t(e,t){"undefined"!=typeof Storage&&localStorage.setItem("autocomplete#query#"+t,e)}function a(e){0===$("#search").val().indexOf(" ")&&$("#search").val($("#search").val().replace(/\s+/g," ").trim()),""===$("#search").val().trim()&&r&&h.val(""),39!==e.keyCode&&r&&h.val("")}function n(e){if(13===e.keyCode&&""!==$("#search").val()){var t=$("#search").val().trim()
searchQuery(t)}}function i(){document.cookie.indexOf("latitude")<0&&$.getScript("/js/min/location_centric.min.js")}$.ajaxSetup({cache:!0})
var s=-1,c=!0,o=0,r=!0,l="",u=!1,p=0
window.searchQuery=function(e){window.location="/cgi-bin/s.py?q="+encodeURIComponent(e)},$(".backinput").remove()
var h=$("#search").clone()
h.removeAttr("id"),h.removeAttr("placeholder"),h.removeAttr("name"),h.removeClass("ui-autocomplete-BACKINPUTut"),h.addClass("backinput"),h.attr("disabled",""),h.attr("id","input_back"),$("#div_for_back").append(h),$(window).on("resize",e),e(),$("#search").on("keypress",e),$("#srmse-logo").on("click",function(){window.location="http://srmsearchengine.in"}),function(e){function t(t,a){var n=new RegExp(e.ui.autocomplete.escapeRegex(a),"i")
return e.grep(t,function(t){return n.test(e("<div>").html(t.label||t.value||t).text())})}var a=e.ui.autocomplete.prototype,n=a._initSource
e.extend(a,{_initSource:function(){this.options.html&&e.isArray(this.options.source)?this.source=function(e,a){a(t(this.options.source,e.term))}:n.call(this)},_renderItem:function(t,a){return e("<li></li>").data("item.autocomplete",a).append(e("<a></a>")[this.options.html?"html":"text"](a.label)).appendTo(t)}})}(jQuery),$("#search").autocomplete({source:function(e,a){function n(){$.ajax({url:"/cgi-bin/ac/getWords.py",dataType:"text",data:{q:e.term,authenticity_token:$("meta[name='csrf-token']").attr("content")},success:function(n){t(n,e.term),a(JSON.parse(n))}})}if("undefined"!=typeof Storage){var i=localStorage.getItem("autocomplete#query#"+e.term)
i?a(JSON.parse(i)):n()}else n()},minLength:1,autoFocus:!1,appendTo:".search_div",html:!0,open:function(e,t){if($("ul.ui-autocomplete").addClass("opened"),$(".ui-helper-hidden-accessible").remove(),$(this).autocomplete("widget").css({width:$("#search").parent().width()+"px"}),-1!==s&&($(".ui-autocomplete").css("postion","relative").css("left",s+"px"),$(".ui-autocomplete").css("width",""),$(".ui-autocomplete >li").css("width","100%"),$(".ui-autocomplete >li>a").css("white-space","nowrap")),e.preventDefault(),$(window).width()<767){var a,n;-1!==s?(a=.9*LAST_WORD_WIDTH+"px",n=.1*LAST_WORD_WIDTH+"px"):(a=.9*$("#search").parent().width()+"px",n=.1*$("#search").parent().width()+"px"),$(".ui-menu-item >a").css("width",a).css("float","left"),$(".ui-menu-item >a").after("<span class='pen'><span class='glyphicon glyphicon-arrow-up copy_g'></span></span>"),$(".pen").css("width",n),$.each($(".pen"),function(e,t){$(this).css("height",parseInt($(this).parent().find("a").height())+"px")})}else-1!==s?$(".ui-menu-item >a").css("width",LAST_WORD_WIDTH+"px").css("float","left"):$(".ui-menu-item >a").css("width",$("#search").parent().width()+"px").css("float","left")},close:function(){$(".ui-menu-item").remove(),$("ul.ui-autocomplete").removeClass("opened").css("display","block")},focus:function(e,t){if(""!==$("#search").val().trim())if(t.item.resize){var a=$("#search").val().split(" ")
r&&h.val((a.slice(0,a.length-1)+" "+t.item.value).replace($("#search").val().toLowerCase(),$("#search").val()))}else t.item.resize?r&&h.val(t.item.value.replace($("#search").val().toLowerCase(),$("#search").val())):($("#search").val(t.item.value),r&&h.val(t.item.value))
if(l&&""!==l){e.preventDefault()
var n=l.split(" "),i=n.slice(0,n.length-1).join(" ")
$("#search").val(i+" "+t.item.value)}},response:function(e,t){var a=[]
if(""!==$("#search").val().trim()&&("true"===t.content[0].resize?(a=$("#search").val().trim().split(" "),r&&h.val(a.slice(0,a.length-1).join(" ")+" "+t.content[0].value)):r&&h.val(t.content[0].value.replace($("#search").val().toLowerCase(),$("#search").val()))),"true"===t.content[0].resize){l=$("#search").val().trim()
var n
if(c){u=!1,p=parseInt($("#search").offset().left),c=!1,n=a.slice(0,a.length-1).join(" ").length*parseInt($("#search").css("font-size").replace("px",""))
var i=a.pop().length*parseInt($("#search").css("font-size").replace("px",""))
LAST_WORD_WIDTH=i+100,o=.7*parseInt(n),s=p+n}else if(u){n=a.slice(0,a.length-1).join(" ").length*parseInt($("#search").css("font-size").replace("px",""))
var i=a.pop().length*parseInt($("#search").css("font-size").replace("px",""))
LAST_WORD_WIDTH=i+100,o=.7*n,s=p+n,u=!1}}else l="",s=-1},select:function(e,t){e.preventDefault()},delay:300}),$("#search").on("keypress",function(e){a(e),n(e)}),$("#search").on("keyup",function(e){a(e),n(e)}),$("#search").on("keydown",function(e){a(e),n(e),39===e.keyCode?document.getElementById("search").selectionStart===$("#search").val().length&&$("#search").val().length<$(".backinput").val().length&&$("#search").val($(".backinput").val()):$(".backinput").val("")}),$("#search_btn").on("click",function(){if(""!==$("#search").val().trim()){var e=$("#search").val().trim()
searchQuery(e)}}),$(window).on("resize",function(){$(".ui-autocomplete").hide(),s=-1,c=!0,o=0}),i(),$("#search").on("keyup",function(e){if(a(e),32===e.keyCode)u=!0
else if(8===e.keyCode){var t=$("#search").val()
" "===t.slice(t.length-1,t.length)&&(u="  "===t.slice(t.length-2,t.length)?!1:!0)}})})}()
