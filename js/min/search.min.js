/*
 Author Tilak Patidar
 email tilakpatidar@gmail.com
 github http://github.com/tilakpatidar      
  */
!function(){"use strict"
$(document).ready(function(){function e(){$("#modalSwitchTheme").remove(),"dark"===window.color?O="rgba(241, 241, 241, 0.74)":"light"===window.color&&(O="rgba(51, 51, 51, 0.74)")
var e=$('<div id="modalSwitchTheme"  style="width:'+$(document).width()+"px;height:"+$(document).height()+"px;position:absolute;left:0px;top:0px;z-index:1000;background-color:"+O+';"></div>')
e.hide().appendTo("body").fadeIn(1e3)}function t(e){window.location="/cgi-bin/s.py?q="+encodeURIComponent(e)}function i(){var e=$(N.replace(/<img (.*?)\/>/g,""))
$.each(e.find("a"),function(){if($(this).attr("href")&&$(this).attr("href").indexOf("File")>=0){$(this).text("")
var e=$("<img>"),t=$(this).attr("href").split("/")
e.attr("src","http://en.wikipedia.org/wiki/en:Special:Filepath/"+t[t.length-1].replace("File:","")+"?width=140"),$(this).append(e)}}),$("#smart_col").html("").append(e.addClass("module").attr("id","wiki")),$("#wiki>a").on("click",function(e){e.stopPropagation()}),$("#smart_answer").addClass("hide"),$("#smart_col").removeClass("hide")}function a(){setTimeout(function(){N&&D?i():z||a()},2e3)}function s(){F.remove(),$(".no-results").remove()
var e=$("<div><span></span></div>")
return e.width($("#search_results").width()),e.addClass("h6 text-center no-results"),e.text("No more results available"),e}function n(){$("#dark_theme").remove(),$("#modalSwitchTheme").fadeOut(1e3,function(){$(this).remove()})}function r(){$("#light_theme").remove(),$("#modalSwitchTheme").fadeOut(1e3,function(){$(this).remove()})}function o(){$(".arrow_div").remove(),$("#arrow_parent").append('<div class="arrow_div"></div>'),H(),$(".side_btns").hide(),U=1,$(".arrow_div").animate({width:"150px"},500,function(){$(".side_btns").fadeIn(),U=0}),++R}function c(){$(".side_btns").fadeOut(function(){$(".side_btns").hide(),$(".arrow_div").css("padding-left","0px"),U=1,$(".arrow_div").animate({width:"0px"},500,function(){U=0}),R=0})}function l(){0===R?o():c()}function d(){var e=$("body"),t=e.offset(),i=t.top
$("html, body").animate({scrollTop:i},500,"linear")}function p(){if($(".newside").remove(),$(".ui-autocomplete").removeClass("show"),$(window).width()<=1e3){$(".disc_back")&&$(".disc_back").css("top","180px"),$("#tap").length<=0&&!M&&q.length>0?($("body").append(G),G.on("click",function(){$(this).slideUp("fast",function(){$(this).hide()})}),M=!0):M||$("#tap").show(),0===q.length?($("#smart_answer").css("margin-top","102px"),$(".side").removeClass("full-height")):($("#smart_col").css("margin-top","62px"),$(".side").addClass("full-height")),$(".side").addClass("hide"),$("#centre_parent").css("margin-top","20px")
var e=$('<div class="newside" style="width:'+$(".nav_changer").width()+'px;"></div'),t=$('<button style="" class="cluster_lbtn btn glyphicon glyphicon-chevron-left"></button>'),i=$('<div style="float:left;height:100%;width:40px;" class=""></div>'),a=$('<div style="float:left;height:100%;width:40px;" class=""></div>'),s=$('<button style="" class="cluster_rbtn btn glyphicon glyphicon-chevron-right"></button>'),n=$('<div style="width:100%;height:100%;padding-top:5px;padding-bottom:5px;"></div>'),r=$('<div style="padding:0px !important;height:50px;width:'+($(".nav_changer").width()-80)+'px;" class="col-lg-10 col-md-10 col-sm-10 col-xs-10"></div>')
if(i.append(s),a.append(t),n.append(a),q.length>0){var o=$()
$.each(q.slice(C,S),function(e,t){var i,a=($(".nav_changer").width()-105)/4
e===S?(i=$('<div data-toggle="tooltip" data-placement="bottom" class="cluster_btn" title="'+t.capitalizeMe()+'" style="width:'+a+'px;"></div>'),i.text(t.capitalizeMe()),o=o.add(i)):(i=$('<div data-toggle="tooltip" data-placement="bottom" class="cluster_btn" title="'+t.capitalizeMe()+'" style="width:'+a+'px;"></div>'),i.text(t.capitalizeMe()),o=o.add(i))}),r.append(o),n.append(r),n.append(i),e.append(n),e.height("50"),$(".nav_changer").prepend(e),r.on("mouseenter","div",function(){$(this).css({color:"#e2e2e2","background-color":"#383838"})}),r.on("mouseleave","div",function(){$(this).css({color:"#e2e2e2","background-color":"transparent"}),r.on("click","div",function(){$(this).addClass("active"),k(this)})}),t.on("click",function(){0!==C&&(C-=3,S-=3,$(".navside").remove(),p())}),s.on("click",function(){S+3<=q.length&&(C+=3,S+=3,$(".navside").remove(),p())})}else _()
$(".newside").css("margin-top","122px")}else $("#tap").hide(),$("#centre_parent").css("margin-top","82px"),$(".newside").css("margin-top","82px"),$("#smart_col").css("margin-top","82px"),q.length>0?$(".side").removeClass("hide"):$("#smart_answer").css("margin-top","22px")}function h(){""!==$("#search").val().trim()&&$.ajax({async:!0,url:"/cgi-bin/queryret/getIds.py",data:{q:$("#search").val().trim().toLowerCase(),f:1,authenticity_token:$("meta[name='csrf-token']").attr("content")},dataType:"text",type:"GET",error:function(){T=!1}}).done(function(e){var t=JSON.parse(e)
t.error?T=!1:(j=t.ids,m(t.results,$("#search_results"),!1,!0,!1),T=!0)})}function m(e,t,i,a,n){if(e[0]){i?N=e[0].infobox:(T=!0,b+=10,x+=10)
var r=$()
$.each(e,function(e,t){var a=$("<div></div>"),s=$('<div style="display:block;"></div>'),n=$("<a></a>")
s.append(n),a.addClass("search_result effect"),n.addClass("search_title")
var o=t.title.replace(/_/g," ").split(" "),c=""
c=o.length>10?o.slice(0,10).join(" ")+" ...":o.slice(0,10).join(" "),i?(n.text(c.capitalizeMe()+" - Wikipedia, the free encyclopedia"),n.attr("href","http://en.wikipedia.org/wiki/"+t.title),t.url="http://en.wikipedia.org/wiki/"+t.title):(n.text(c.capitalizeMe()),n.attr("href",t.url))
var l=$("<div></div>")
l.addClass("search_green"),l.append(t.url)
var d=new Image,p="http://www.google.com/s2/favicons?domain="+t.url
d.src=p,d.width=15,d.height=15,$(d).css("margin-right","10px"),d.onload=function(){l.prepend(d),a.find(".search_info").after(l)}
var h=$("<p></p>")
h.addClass("search_info"),i?h.html(t.body):h.text(t.body),a.append(s),a.append(h),r=r.add(a)}),r=r.add('<hr class="hr_breaker">'),a?t.append(r):t.html(r),$(".search_result").on("click",function(){window.location=$(this).find(".search_title").attr("href")}),$(".search_result").on("mouseenter",function(){"light"===window.color?($(this).find(".search_title").css("color","rgba(71, 71, 71, 0.85)"),$(this).find(".search_title").css("text-decoration","underline")):"dark"===window.color&&($(this).find(".search_title").css("color","#DDDDDD"),$(this).find(".search_title").css("text-decoration","underline"))}),$(".search_result").on("mouseleave",function(){"light"===window.color?($(".search_title").css("color","#474747"),$(".search_title").css("text-decoration","none")):"dark"===window.color&&($(".search_title").css("color","#DFDDDD"),$(".search_title").css("text-decoration","none"))}),$(".effect").animate({opacity:1,queue:!1},1e3,function(){}),$(".effect").removeClass("effect"),$("#loading").remove(),$(window).scroll(g)}else{var o=s()
i||n||(T=!1,t.append(o))}}function u(e,t){if(b<j.length)j&&T&&$.ajax({url:"/cgi-bin/queryret/getMore.py",dataType:"text",type:"GET",async:!0,data:{q:""+j.slice(b,x).toString(),f:"1",authenticity_token:$("meta[name='csrf-token']").attr("content")},error:function(){$("#search_results").append(i),T=!1}}).done(function(e){var t=JSON.parse(e)
t.error?T=!1:m(t.results,$("#search_results"),!1,!0,!1)})
else{var i=s()
$("#search_results").append(i),T=!1}}function g(){$(window).scrollTop()+$(window).height()>$(document).height()-100&&($(window).unbind("scroll"),T&&($("#search_results").append(F),$("#loading").width($("#search_results").width()),setTimeout(function(){u(b,x,!0)},1e3)))}function f(){$.ajax({async:!0,url:"/cgi-bin/queryret/getIds.py",dataType:"text",type:"GET",data:{q:$("#search").val().trim().toLowerCase(),f:2,authenticity_token:$("meta[name='csrf-token']").attr("content")},error:function(){}}).done(function(e){try{var t=JSON.parse(e)
t.error||m(t.results,$("#wikiMain"),!0,!0,!1)}catch(i){}})}function w(e){$.ajax({async:e,url:"/cgi-bin/queryret/getIds.py",dataType:"text",type:"GET",data:{q:$("#search").val().trim().toLowerCase(),f:3,authenticity_token:$("meta[name='csrf-token']").attr("content")},error:function(){}}).done(function(e){try{var t=JSON.parse(e)
t.error||m(t.results,$("#news"),!1,!0,!0)}catch(i){}})}function v(){""!==$("#search").val().trim()&&$.ajax({async:!0,url:"/cgi-bin/new2/smart/getSmartAns.py",dataType:"text",type:"GET",data:{q:$("#search").val().trim().toLowerCase(),authenticity_token:$("meta[name='csrf-token']").attr("content")},error:function(){$("#smart_answer").removeClass("show"),$("#smart_col").addClass("hide")}}).done(function(e){try{var t=JSON.parse(e.replace(/\n/g,"").trim())
if(t.error)return $("#smart_answer").removeClass("show"),void $("#smart_col").addClass("hide")
$.isEmptyObject(t)?($("#search").val().trim().toLowerCase().indexOf("convert")>-1&&($.getScript("/js/min/glaConv.min.js"),$.getScript("/js/min/metric.min.js"),$.getScript("/js/min/convert.min.js")),console.log("No smart  ans questions !"),$("#smart_answer").addClass("hide"),$("#smart_col").addClass("hide")):$.each(t,function(e,t){switch(window.SA=t,e){case"general":$.getScript("/js/min/general.min.js"),D=!0
break
case"sports":$.getScript("/js/min/cric_score.min.js"),z=!0
break
case"stock":$.getScript("/js/min/stocks.min.js"),z=!0
break
case"train":$.getScript("/js/min/train.min.js"),z=!0
break
case"weather":$.getScript("/js/min/weather.min.js"),z=!0
break
case"movie":$.getScript("/js/min/movie.min.js"),D=!0
break
case"exam":$.getScript("/js/min/exam.min.js"),z=!0
break
case"location":$.getScript("/js/min/locations.min.js"),z=!0
break
case"minerals":$.getScript("/js/min/minerals.min.js"),z=!0
break
case"differences":$.getScript("/js/min/differences.min.js"),D=!0
break
case"wiki":D=!0
break
case"dict":$.getScript("/js/min/meaning.min.js"),D=!0
break
case"theatre":$.getScript("/js/min/theater.min.js"),D=!0
break
case"highway":$.getScript("/js/min/highway.min.js"),z=!0
break
case"cricket-players":$.getScript("/js/min/cricket.min.js"),D=!0
break
case"ministers":$.getScript("/js/min/ministers.min.js"),z=!0
break
case"bank":$.getScript("/js/min/bank.min.js"),z=!0
break
case"highcourt":$.getScript("/js/min/highcourt.min.js"),z=!0
break
case"discography":$.getScript("/js/min/discography.min.js"),D=!0
break
default:$("#smart_answer").addClass("hide"),D=!0}})}catch(i){console.log("No smart  ans questions !"),$("#smart_answer").addClass("hide"),$("#smart_col").addClass("hide")}})}function y(){q=[],$(".side").removeClass("col-md-2 col-lg-2 hide"),$(".side").addClass("col-md-1 col-lg-1"),$("#centre_parent").parent().removeClass("col-lg-7 col-md-7 col-lg-pull-3 col-md-pull-3"),$("#centre_parent").parent().addClass("col-lg-8 col-md-8 col-lg-pull-3 col-md-pull-3"),$("#smart_col").parent().removeClass("col-lg-push-7 col-md-push-7 col-lg-3 col-md-3"),$("#smart_col").parent().addClass("col-lg-push-8 col-md-push-8 col-lg-3 col-md-3")}function _(){""!==$("#search").val().trim()&&$.ajax({async:!0,url:"/cgi-bin/cluster/getClusters.py",dataType:"text",type:"GET",data:{q:$("#search").val().trim().toLowerCase(),authenticity_token:$("meta[name='csrf-token']").attr("content")},error:function(){y()}}).done(function(e){var t=JSON.parse(e)
if(t.error)return void y()
E=t
var i=[]
if($.each(t,function(e,t){i.push(L[e])}),i.length>0){var a=$()
q=i,$.each(i,function(e,t){if(t){var i=$("<li></li>"),s=$("<a></a>")
s.attr("data-toggle","tooltip"),s.attr("data-placement","right"),s.attr("title",t.capitalizeMe()),s.on("click",function(){$(".active").toggleClass("active not_active"),$(this).parent().toggleClass("not_active active"),k(this)}),s.text(t.capitalizeMe()),i.append(s),i.addClass("not_active"),i.css("opacity","0"),a=a.add(i),$(".side").removeClass("hide"),p()}}),$(".nav-sidebar").append(a),a.animate({opacity:"1",queue:!1},1e3,function(){})}else console.log("no clusters"),q=[],$(".side").html(""),$(".side").removeClass("hide"),$(".side").removeClass("col-md-2 col-lg-2"),$(".side").addClass("col-md-1 col-lg-1"),$("#centre_parent").parent().removeClass("col-lg-7 col-md-7 col-lg-pull-3 col-md-pull-3"),$("#centre_parent").parent().addClass("col-lg-8 col-md-8 col-lg-pull-3 col-md-pull-3"),$("#smart_col").parent().removeClass("col-lg-push-7 col-md-push-7 col-lg-3 col-md-3"),$("#smart_col").parent().addClass("col-lg-push-8 col-md-push-8 col-lg-3 col-md-3")})}function k(e){var t=$(e).text()
"News"!==t?$("#news").addClass("hide"):$("#news").removeClass("hide")
var i=A[t],a=E[i]
return j=a,b=0,x=10,$.ajax({async:!0,url:"/cgi-bin/queryret/getMore.py",dataType:"text",type:"GET",data:{q:j.slice(b,x).toString(),f:1,authenticity_token:$("meta[name='csrf-token']").attr("content")},error:function(){var e=s()
$("#search_results").append(e)}}).done(function(e){var t=JSON.parse(e)
if(t.error){var i=s()
$("#search_results").append(i)}else m(t.results,$("#search_results"),!1,!1,!1)}),!1}$.ajaxSetup({cache:!0}),$.getScript("/js/min/jquery-ui.min.js",function(){$.getScript("/js/min/auto.min.js")})
var b=0,x=10,j=[],C=0,S=4,T=!0,q=[]
window.SA={}
var M=!1,D=!1,z=!1,E=[],N="",O="",F=$('<div id="loading" style="background-color:#333333;"><img src="/images/ajax-loader.gif" width="20" height="20"/></div>'),I=$('<div style="position:relative;top:0;bottom:0;padding-top:18px;height:50px;"><span id="light" class="side_btns" data-toggle="tooltip" title="Light Theme"><img style="top:0;bottom:0;margin:auto;width:31px;height:27px;" src="/images/lighttheme.png"></span><span   class="side_btns" id="dark" data-toggle="tooltip" title="Dark Theme"><img style="top:0;bottom:0;margin:auto;width:31px;height:27px;margin-left:5px;" src="/images/darktheme.png">   </span> <span class="side_btns" data-toggle="tooltip" title="Want Help !">  <img style="top:0;bottom:0;margin:auto;width:31px;height:27px;margin-left:5px;" src="/images/howtouse.png">      </span> </div>'),G=$('<div id="tap" style="position:absolute;top:122px;width:100%;height:46px;z-index:99;"><button class="btn tap-btn" style="width:100%;height:100%;" type="button">Tap to see clusters</button></div>'),A={Architecture:"100",Arts:"101",Education:"102",Entertainment:"103",Finance:"104",Food:"105",Health:"106",History:"107",News:"108",Sports:"109",Technology:"110",Religion:"111"},L={100:"Architecture",101:"Arts",102:"Education",103:"Entertainment",104:"Finance",105:"Food",106:"Health",107:"History",108:"News",109:"Sports",110:"Technology",111:"Religion"}
a(),window.switchImg=function(){var e=[],t=$(".switch")
return $.each(t,function(){"dark"===window.color&&$(this).attr("src",$(this).attr("src").replace("/light/","/dark/")),"light"===window.color&&$(this).attr("src",$(this).attr("src").replace("/dark/","/light/")),e.push($(this))}),e}
var J=$("#srmse-logo")
J.addClass("switch"),"dark"===window.color?($("head").append("<link id=\"dark_theme\" rel='stylesheet' type='text/css' href='/css/dark/search.min.css' />"),J.attr("src","/images/dark/srmselogo.png")):(J.attr("src","/images/light/srmselogo.png"),$("head").append("<link id=\"light_theme\" rel='stylesheet' type='text/css' href='/css/light/search.min.css' />")),J.attr("alt","SRM Search Engine")
var H=function(){$(".arrow_div").css("padding-left","20px"),$(".arrow_div").append(I),$(".side_btns").css("cursor","pointer"),$("#light").on("click",function(){if("light"===window.color)return e(),void n()
$("#light_theme").remove(),window.color="light",document.cookie="color=light;expires=Fri, 31 Dec 9999 23:59:59 GMT;path=/"
var t=window.switchImg(),i=t.length+1,a=0,s=$("<link id=\"light_theme\" rel='stylesheet' type='text/css' href='/css/light/search.min.css' />")
$("head").append(s),e(),$.each(t,function(e,t){!function(e){e.load(function(){++a,a===i&&n()})}(t)}),s.load(function(){++a,a===i&&n()})}),$("#dark").on("click",function(){if("dark"===window.color)return e(),void r()
$("#dark_theme").remove(),window.color="dark",document.cookie="color=dark;expires=Fri, 31 Dec 9999 23:59:59 GMT;path=/"
var t=window.switchImg(),i=t.length+1,a=0,s=$("<link id=\"dark_theme\" rel='stylesheet' type='text/css' href='/css/dark/search.min.css' />")
$("head").append(s),e(),$.each(t,function(e,t){!function(e){e.load(function(){++a,a===i&&r()})}(t)}),s.load(function(){++a,a===i&&r()})})},R=0,U=0
$.getScript("/js/min/jquery.mobile.custom.min.js",function(){$("#arrow,#arrow_parent").on("swipeleft",function(){0===R&&0===U&&o()}),$("#arrow,#arrow_parent").on("swiperight",function(){0!==R&&0===U&&c()})}),$("#arrow").on("click",l),$(function(){$(document).on("scroll",function(){$(window).scrollTop()>100?($(".scroll-top-wrapper").addClass("show"),setTimeout(function(){$(".scroll-top-wrapper").removeClass("show")},4e3)):$(".scroll-top-wrapper").removeClass("show")}),$(".scroll-top-wrapper").on("click",d)}),p(),$(window).on("resize",p),$("#search_btn").on("submit",function(){if(""!==$("#search").val().trim()){var e=$("#search").val().trim()
t(e)}return!1}),$("#logo").on("click",function(){window.location="/"}),$(window).bind("scroll",g),h(),f(),w(),v(),_()}),String.prototype.capitalizeMe=function(){try{return this.charAt(0).toUpperCase()+this.substr(1).toLowerCase()}catch(e){return""}},String.prototype.filter=function(){try{var e=this+" "
return e=e.replace(/\\[a-z](.*?)\s/g," ").replace(/\\n+/g," ").replace(/\\t+/g," ").replace(/\\r+/g," ").replace(/\\/g," ").replace(/&#(.*?)\s;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/<(.*?)>(.*?)<\/(.*?)>/g," ").replace(/\s+/g," ").trim()}catch(t){return""}},$.prototype.setTextValue=function(e){""===e||void 0===e?$(this).remove():$(this).text(e)},$.prototype.setHtmlValue=function(e,t){""===t||void 0===t?$(this).remove():$(this).html(e)}}()
